## 专业建议
- 分层按职责解耦，保证上下依赖清晰：
  - Providers（最底层）只封装外部数据源 API；无业务逻辑
  - Fetchers（远端获取）编排获取与落盘；依赖 Providers
  - Loaders（本地读取）只读本地与缓存；不做网络
  - Calendars（交易日历）独立：缓存读写与远端增量获取
- 好处：
  - 职责单一、测试友好、替换数据源代价低
  - 运行路径清晰：Loader → 缺失评估 → 上层决定 → Fetcher 拉取

## 目录结构（建议）
- `src/data/`（数据层根）
  - `providers/`：数据源适配
    - `base.py`、`tushare_provider.py`、`akshare_provider.py`
  - `fetchers/`：远端获取与落盘
    - `stock_fetcher.py`（原 `stock_data_fetcher.py`）
    - 可扩展：`factor_fetcher.py` 等
  - `loaders/`：本地读取与缺失评估
    - `stock_loader.py`（原 `stock_data_loader.py`）
  - `calendars/`：交易日历
    - `calendar_cache.py`、`calendar_fetcher.py`
  - `__init__.py`：导出稳定接口

## 命名与接口
- Providers：`get_daily_k_data(ts_code, start, end)`、`get_trade_calendar(start, end)`、`get_adj_factor(...)`
- Fetchers：
  - `StockFetcher.get_daily_k_data(..., save_local=True)`
  - `StockFetcher.update_stock_data(ts_code)`、`update_all_stocks_data(limit=None)`
  - 依赖 `CalendarFetcher.ensure(...)` 做日历覆盖
- Loaders：
  - `StockLoader.load(ts_code)`、`check_missing(...) -> MissingInfo`
  - `check_missing_multi(ts_codes, ...) -> DataFrame`
- Calendars：
  - Cache：`load(exchange)`、`save(exchange, df)`
  - Fetcher：`fetch(start, end)`、`ensure(exchange, start, end)`

## 渐进式迁移计划
1. 新建 `src/data/` 目录与子包，添加 `__init__.py`
2. 移动文件并重命名：
   - `src/data_fetch/providers/*` → `src/data/providers/*`
   - `src/data_fetch/stock_data_fetcher.py` → `src/data/fetchers/stock_fetcher.py`
   - `src/data_fetch/stock_data_loader.py` → `src/data/loaders/stock_loader.py`
   - `src/data_fetch/calendar_*` → `src/data/calendars/`
3. 统一路径常量使用 `project_var`（已完成的继续保留）
4. 修订导入路径：脚本与策略模块引用新包路径
5. 保持对外稳定入口（兼容层）：
   - 在旧位置保留轻量导出或废弃提示，避免一次性破坏

## 脚本影响
- `scripts/run_fetcher.py`：改用 `from src.data.loaders.stock_loader import StockLoader`、`from src.data.fetchers.stock_fetcher import StockFetcher`、`from src.data.calendars.calendar_fetcher import CalendarFetcher`
- `scripts/run_strategies.py`：只读 Loader（或保留原 `StockDailyKLineFetcher.load_local_data` 的兼容封装）

## 验证
- 单测：接口导入路径、功能对齐
- 集成：运行 `run_fetcher.py --workers` 与 `run_strategies.py`，确认无网络耦合与输出正常

## 交付节奏
- 先完成目录创建与文件迁移、修正导入
- 加入兼容导出，逐步迁移脚本引用
- 保持最小可用改动，后续再优化命名与文档